const Rx = require('rx');
const Net = require('net');
const RxNode = require('rx-node');

function fromFtpSocket(host, port) {
  let ftpSocket = Net.createConnection(port, host);
  let source$ = RxNode.fromStream(ftpSocket);
  //let cmd$ = new Rx.Subject();
  let observer = Rx.Observer.create(cmd => {
	//cmd$.onNext(cmd);
	ftpSocket.send(cmd + '\r\n');
  });

  return Rx.Subject.create(observer, source$);
}

module.exports = fromFtpSocket;

/*
   let s = fromFtpSocket('localhost', 21);

   s.subscribe(out => console.log(out.toString()));

   s.onNext('SYST\r\n');
   */
